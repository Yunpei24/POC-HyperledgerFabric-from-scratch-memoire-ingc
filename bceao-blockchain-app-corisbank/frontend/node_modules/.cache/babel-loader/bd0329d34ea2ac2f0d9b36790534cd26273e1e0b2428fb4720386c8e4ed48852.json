{"ast":null,"code":"var _jsxFileName = \"/home/hlfuser/Bureau/HLF_project_jyen/bceao-blockchain-app/frontend/src/components/ActiveClientList.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { getActiveClients, getClientHistory } from '../services/api';\nimport ClientListBase from './common/ClientListBase';\nimport ClientHistoryModal from './common/ClientHistoryModal';\nimport ClientSearchBar from './common/ClientSearchBar';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function ActiveClientList() {\n  _s();\n  const [clients, setClients] = useState([]);\n  const [filteredClients, setFilteredClients] = useState([]);\n  const [queryInfo, setQueryInfo] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [showHistory, setShowHistory] = useState(false);\n  const [selectedClientHistory, setSelectedClientHistory] = useState(null);\n  const [historyLoading, setHistoryLoading] = useState(false);\n  useEffect(() => {\n    loadClients();\n  }, []);\n  const loadClients = async () => {\n    try {\n      setLoading(true);\n      const response = await getActiveClients();\n      if (response !== null && response !== void 0 && response.clients) {\n        setClients(response.clients);\n        setFilteredClients(response.clients);\n        setQueryInfo(response.queryInfo);\n      }\n    } catch (err) {\n      setError(err.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const handleSearch = async ({\n    type,\n    params,\n    image\n  }) => {\n    if (type === 'FACE' && image) {\n      try {\n        setLoading(true);\n        const similarClients = await searchClientsByFace(image, clients);\n        setFilteredClients(similarClients);\n        setQueryInfo(prev => ({\n          ...prev,\n          totalResults: similarClients.length,\n          searchType: 'Face Recognition'\n        }));\n      } catch (error) {\n        setError(error.message);\n      } finally {\n        setLoading(false);\n      }\n    } else if (type === 'TEXT') {\n      let filtered = [...clients];\n      if (params.ubi) {\n        filtered = filtered.filter(client => client.UBI.toLowerCase().includes(params.ubi.toLowerCase()));\n      }\n      if (params.lastName) {\n        filtered = filtered.filter(client => client.lastName.toLowerCase().includes(params.lastName.toLowerCase()));\n      }\n      if (params.firstName) {\n        filtered = filtered.filter(client => client.firstName.toLowerCase().includes(params.firstName.toLowerCase()));\n      }\n      setFilteredClients(filtered);\n      setQueryInfo(prev => ({\n        ...prev,\n        totalResults: filtered.length\n      }));\n    }\n  };\n  const handleShowHistory = async ubi => {\n    try {\n      setHistoryLoading(true);\n      const history = await getClientHistory(ubi);\n      setSelectedClientHistory(history);\n      setShowHistory(true);\n    } catch (err) {\n      setError(err.message);\n    } finally {\n      setHistoryLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container mx-auto px-4 py-6\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-6\",\n      children: [/*#__PURE__*/_jsxDEV(ClientSearchBar, {\n        onSearch: handleSearch\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ClientListBase, {\n        title: \"Clients Actifs\",\n        clients: filteredClients,\n        queryInfo: queryInfo,\n        loading: loading,\n        error: error,\n        onShowHistory: handleShowHistory\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 9\n      }, this), showHistory && /*#__PURE__*/_jsxDEV(ClientHistoryModal, {\n        history: selectedClientHistory,\n        onClose: () => {\n          setShowHistory(false);\n          setSelectedClientHistory(null);\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 11\n      }, this), historyLoading && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"animate-spin rounded-full h-12 w-12 border-b-2 border-white\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 95,\n    columnNumber: 5\n  }, this);\n}\n_s(ActiveClientList, \"e7wkchvH40SCLZsW6J3h1aQ+aAo=\");\n_c = ActiveClientList;\nvar _c;\n$RefreshReg$(_c, \"ActiveClientList\");","map":{"version":3,"names":["React","useState","useEffect","getActiveClients","getClientHistory","ClientListBase","ClientHistoryModal","ClientSearchBar","jsxDEV","_jsxDEV","ActiveClientList","_s","clients","setClients","filteredClients","setFilteredClients","queryInfo","setQueryInfo","loading","setLoading","error","setError","showHistory","setShowHistory","selectedClientHistory","setSelectedClientHistory","historyLoading","setHistoryLoading","loadClients","response","err","message","handleSearch","type","params","image","similarClients","searchClientsByFace","prev","totalResults","length","searchType","filtered","ubi","filter","client","UBI","toLowerCase","includes","lastName","firstName","handleShowHistory","history","className","children","onSearch","fileName","_jsxFileName","lineNumber","columnNumber","title","onShowHistory","onClose","_c","$RefreshReg$"],"sources":["/home/hlfuser/Bureau/HLF_project_jyen/bceao-blockchain-app/frontend/src/components/ActiveClientList.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { getActiveClients, getClientHistory } from '../services/api';\nimport ClientListBase from './common/ClientListBase';\nimport ClientHistoryModal from './common/ClientHistoryModal';\nimport ClientSearchBar from './common/ClientSearchBar';\n\nexport default function ActiveClientList() {\n  const [clients, setClients] = useState([]);\n  const [filteredClients, setFilteredClients] = useState([]);\n  const [queryInfo, setQueryInfo] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [showHistory, setShowHistory] = useState(false);\n  const [selectedClientHistory, setSelectedClientHistory] = useState(null);\n  const [historyLoading, setHistoryLoading] = useState(false);\n\n  useEffect(() => {\n    loadClients();\n  }, []);\n\n  const loadClients = async () => {\n    try {\n      setLoading(true);\n      const response = await getActiveClients();\n      if (response?.clients) {\n        setClients(response.clients);\n        setFilteredClients(response.clients);\n        setQueryInfo(response.queryInfo);\n      }\n    } catch (err) {\n      setError(err.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleSearch = async ({ type, params, image }) => {\n    if (type === 'FACE' && image) {\n      try {\n        setLoading(true);\n        const similarClients = await searchClientsByFace(image, clients);\n        \n        setFilteredClients(similarClients);\n        setQueryInfo(prev => ({\n          ...prev,\n          totalResults: similarClients.length,\n          searchType: 'Face Recognition'\n        }));\n      } catch (error) {\n        setError(error.message);\n      } finally {\n        setLoading(false);\n      }\n    } else if (type === 'TEXT') {\n      let filtered = [...clients];\n\n      if (params.ubi) {\n        filtered = filtered.filter(client =>\n          client.UBI.toLowerCase().includes(params.ubi.toLowerCase())\n        );\n      }\n      if (params.lastName) {\n        filtered = filtered.filter(client =>\n          client.lastName.toLowerCase().includes(params.lastName.toLowerCase())\n        );\n      }\n      if (params.firstName) {\n        filtered = filtered.filter(client =>\n          client.firstName.toLowerCase().includes(params.firstName.toLowerCase())\n        );\n      }\n\n      setFilteredClients(filtered);\n      setQueryInfo(prev => ({\n        ...prev,\n        totalResults: filtered.length\n      }));\n    }\n  };\n\n  const handleShowHistory = async (ubi) => {\n    try {\n      setHistoryLoading(true);\n      const history = await getClientHistory(ubi);\n      setSelectedClientHistory(history);\n      setShowHistory(true);\n    } catch (err) {\n      setError(err.message);\n    } finally {\n      setHistoryLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"container mx-auto px-4 py-6\">\n      <div className=\"space-y-6\">\n        <ClientSearchBar onSearch={handleSearch} />\n\n        <ClientListBase\n          title=\"Clients Actifs\"\n          clients={filteredClients}\n          queryInfo={queryInfo}\n          loading={loading}\n          error={error}\n          onShowHistory={handleShowHistory}\n        />\n\n        {showHistory && (\n          <ClientHistoryModal\n            history={selectedClientHistory}\n            onClose={() => {\n              setShowHistory(false);\n              setSelectedClientHistory(null);\n            }}\n          />\n        )}\n\n        {historyLoading && (\n          <div className=\"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center\">\n            <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-white\" />\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}