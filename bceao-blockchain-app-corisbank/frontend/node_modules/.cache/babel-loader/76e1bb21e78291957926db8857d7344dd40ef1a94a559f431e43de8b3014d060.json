{"ast":null,"code":"var _jsxFileName = \"/home/hlfuser/Bureau/HLF_project_jyen/bceao-blockchain-app/frontend/src/components/AllClientsList.js\",\n  _s = $RefreshSig$();\n// frontend/src/components/AllClientsList.js\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { getAllClients, getClientHistory } from '../services/api';\nimport ClientListBase from './common/ClientListBase';\nimport ClientHistoryModal from './common/ClientHistoryModal';\nimport ClientSearchBar from './common/ClientSearchBar';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function AllClientsList() {\n  _s();\n  const [clients, setClients] = useState([]);\n  const [filteredClients, setFilteredClients] = useState([]);\n  const [queryInfo, setQueryInfo] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [showHistory, setShowHistory] = useState(false);\n  const [selectedClientHistory, setSelectedClientHistory] = useState(null);\n  const [historyLoading, setHistoryLoading] = useState(false);\n  useEffect(() => {\n    loadClients();\n  }, []);\n  const loadClients = async () => {\n    try {\n      setLoading(true);\n      const response = await getAllClients();\n      if (Array.isArray(response)) {\n        setClients(response);\n        setFilteredClients(response);\n        if (response.length > 0 && response[0].queryMetadata) {\n          setQueryInfo({\n            totalResults: response.length,\n            querier: response[0].queryMetadata.queriedBy.mspId,\n            timestamp: response[0].queryMetadata.queriedBy.timestamp\n          });\n        }\n      } else {\n        console.error('Format de réponse inattendu:', response);\n        setClients([]);\n        setFilteredClients([]);\n        setQueryInfo(null);\n      }\n    } catch (err) {\n      console.error('Erreur lors du chargement des clients:', err);\n      setError('Erreur lors du chargement des clients');\n      setClients([]);\n      setFilteredClients([]);\n      setQueryInfo(null);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const handleSearch = useCallback(({\n    ubi,\n    firstName,\n    lastName\n  }) => {\n    let filtered = [...clients];\n\n    // Filtrer par UBI\n    if (ubi) {\n      filtered = filtered.filter(client => client.UBI.toLowerCase().includes(ubi.toLowerCase()));\n    }\n\n    // Filtrer par Nom\n    if (lastName) {\n      filtered = filtered.filter(client => client.lastName.toLowerCase().includes(lastName.toLowerCase()));\n    }\n\n    // Filtrer par Prénom\n    if (firstName) {\n      filtered = filtered.filter(client => client.firstName.toLowerCase().includes(firstName.toLowerCase()));\n    }\n    setFilteredClients(filtered);\n\n    // Mettre à jour queryInfo avec les résultats filtrés\n    if (queryInfo) {\n      setQueryInfo(prev => ({\n        ...prev,\n        totalResults: filtered.length\n      }));\n    }\n  }, [clients, queryInfo]);\n  const handleShowHistory = async ubi => {\n    try {\n      setHistoryLoading(true);\n      const history = await getClientHistory(ubi);\n      setSelectedClientHistory(history);\n      setShowHistory(true);\n    } catch (err) {\n      console.error(err);\n    } finally {\n      setHistoryLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container mx-auto px-4 py-6\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-6\",\n      children: [/*#__PURE__*/_jsxDEV(ClientSearchBar, {\n        onSearch: handleSearch\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(ClientListBase, {\n        title: \"Tous les Clients\",\n        clients: filteredClients,\n        queryInfo: queryInfo,\n        loading: loading,\n        error: error,\n        onShowHistory: handleShowHistory\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 17\n      }, this), showHistory && /*#__PURE__*/_jsxDEV(ClientHistoryModal, {\n        history: selectedClientHistory,\n        onClose: () => {\n          setShowHistory(false);\n          setSelectedClientHistory(null);\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 21\n      }, this), historyLoading && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"animate-spin rounded-full h-12 w-12 border-b-2 border-white\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 104,\n    columnNumber: 9\n  }, this);\n}\n_s(AllClientsList, \"yZF/Q34E2bqkau2mwvT5t/kmhYU=\");\n_c = AllClientsList;\nvar _c;\n$RefreshReg$(_c, \"AllClientsList\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","getAllClients","getClientHistory","ClientListBase","ClientHistoryModal","ClientSearchBar","jsxDEV","_jsxDEV","AllClientsList","_s","clients","setClients","filteredClients","setFilteredClients","queryInfo","setQueryInfo","loading","setLoading","error","setError","showHistory","setShowHistory","selectedClientHistory","setSelectedClientHistory","historyLoading","setHistoryLoading","loadClients","response","Array","isArray","length","queryMetadata","totalResults","querier","queriedBy","mspId","timestamp","console","err","handleSearch","ubi","firstName","lastName","filtered","filter","client","UBI","toLowerCase","includes","prev","handleShowHistory","history","className","children","onSearch","fileName","_jsxFileName","lineNumber","columnNumber","title","onShowHistory","onClose","_c","$RefreshReg$"],"sources":["/home/hlfuser/Bureau/HLF_project_jyen/bceao-blockchain-app/frontend/src/components/AllClientsList.js"],"sourcesContent":["// frontend/src/components/AllClientsList.js\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { getAllClients, getClientHistory } from '../services/api';\nimport ClientListBase from './common/ClientListBase';\nimport ClientHistoryModal from './common/ClientHistoryModal';\nimport ClientSearchBar from './common/ClientSearchBar';\n\nexport default function AllClientsList() {\n    const [clients, setClients] = useState([]);\n    const [filteredClients, setFilteredClients] = useState([]);\n    const [queryInfo, setQueryInfo] = useState(null);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState(null);\n    const [showHistory, setShowHistory] = useState(false);\n    const [selectedClientHistory, setSelectedClientHistory] = useState(null);\n    const [historyLoading, setHistoryLoading] = useState(false);\n\n    useEffect(() => {\n        loadClients();\n    }, []);\n\n    const loadClients = async () => {\n        try {\n            setLoading(true);\n            const response = await getAllClients();\n\n            if (Array.isArray(response)) {\n                setClients(response);\n                setFilteredClients(response);\n                \n                if (response.length > 0 && response[0].queryMetadata) {\n                    setQueryInfo({\n                        totalResults: response.length,\n                        querier: response[0].queryMetadata.queriedBy.mspId,\n                        timestamp: response[0].queryMetadata.queriedBy.timestamp\n                    });\n                }\n            } else {\n                console.error('Format de réponse inattendu:', response);\n                setClients([]);\n                setFilteredClients([]);\n                setQueryInfo(null);\n            }\n        } catch (err) {\n            console.error('Erreur lors du chargement des clients:', err);\n            setError('Erreur lors du chargement des clients');\n            setClients([]);\n            setFilteredClients([]);\n            setQueryInfo(null);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleSearch = useCallback(({ ubi, firstName, lastName }) => {\n        let filtered = [...clients];\n\n        // Filtrer par UBI\n        if (ubi) {\n            filtered = filtered.filter(client => \n                client.UBI.toLowerCase().includes(ubi.toLowerCase())\n            );\n        }\n\n        // Filtrer par Nom\n        if (lastName) {\n            filtered = filtered.filter(client => \n                client.lastName.toLowerCase().includes(lastName.toLowerCase())\n            );\n        }\n\n        // Filtrer par Prénom\n        if (firstName) {\n            filtered = filtered.filter(client => \n                client.firstName.toLowerCase().includes(firstName.toLowerCase())\n            );\n        }\n\n        setFilteredClients(filtered);\n\n        // Mettre à jour queryInfo avec les résultats filtrés\n        if (queryInfo) {\n            setQueryInfo(prev => ({\n                ...prev,\n                totalResults: filtered.length\n            }));\n        }\n    }, [clients, queryInfo]);\n\n    const handleShowHistory = async (ubi) => {\n        try {\n            setHistoryLoading(true);\n            const history = await getClientHistory(ubi);\n            setSelectedClientHistory(history);\n            setShowHistory(true);\n        } catch (err) {\n            console.error(err);\n        } finally {\n            setHistoryLoading(false);\n        }\n    };\n\n    return (\n        <div className=\"container mx-auto px-4 py-6\">\n            <div className=\"space-y-6\">\n                {/* Barre de recherche */}\n                <ClientSearchBar onSearch={handleSearch} />\n\n                {/* Liste des clients */}\n                <ClientListBase\n                    title=\"Tous les Clients\"\n                    clients={filteredClients}\n                    queryInfo={queryInfo}\n                    loading={loading}\n                    error={error}\n                    onShowHistory={handleShowHistory}\n                />\n\n                {/* Modal d'historique */}\n                {showHistory && (\n                    <ClientHistoryModal\n                        history={selectedClientHistory}\n                        onClose={() => {\n                            setShowHistory(false);\n                            setSelectedClientHistory(null);\n                        }}\n                    />\n                )}\n\n                {/* Indicateur de chargement pour l'historique */}\n                {historyLoading && (\n                    <div className=\"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center\">\n                        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-white\"></div>\n                    </div>\n                )}\n            </div>\n        </div>\n    );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}