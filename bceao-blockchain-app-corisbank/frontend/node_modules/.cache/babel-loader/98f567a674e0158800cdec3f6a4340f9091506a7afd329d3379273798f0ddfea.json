{"ast":null,"code":"var _jsxFileName = \"/home/hlfuser/Bureau/HLF_project_jyen/bceao-blockchain-app/frontend/src/components/ActiveClientList.js\",\n  _s = $RefreshSig$();\n// frontend/src/components/ActiveClientList.js\nimport React, { useState, useEffect } from 'react';\nimport { getActiveClients, getClientHistory } from '../services/api';\nimport ClientListBase from './common/ClientListBase';\nimport ClientHistoryModal from './common/ClientHistoryModal';\nimport ClientSearchBar from './common/ClientSearchBar';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function ActiveClientList() {\n  _s();\n  const [clients, setClients] = useState([]);\n  const [filteredClients, setFilteredClients] = useState([]);\n  const [queryInfo, setQueryInfo] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [showHistory, setShowHistory] = useState(false);\n  const [selectedClientHistory, setSelectedClientHistory] = useState(null);\n  const [historyLoading, setHistoryLoading] = useState(false);\n  useEffect(() => {\n    loadClients();\n  }, []);\n  const loadClients = async () => {\n    try {\n      setLoading(true);\n      const response = await getActiveClients();\n      if (response !== null && response !== void 0 && response.clients) {\n        setClients(response.clients);\n        setFilteredClients(response.clients);\n        setQueryInfo(response.queryInfo);\n      }\n    } catch (err) {\n      setError(err.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const handleSearch = ({\n    type,\n    params,\n    result,\n    error: searchError,\n    searchType\n  }) => {\n    if (searchError) {\n      setError(searchError);\n      return;\n    }\n    if (type === 'FACE') {\n      // Si aucun résultat similaire n'est trouvé\n      if (!result || result.length === 0) {\n        setFilteredClients([]);\n        setQueryInfo(prev => ({\n          ...prev,\n          totalResults: 0,\n          searchType: searchType,\n          message: \"Aucun client similaire trouvé\"\n        }));\n      } else {\n        setFilteredClients(result);\n        setQueryInfo(prev => ({\n          ...prev,\n          totalResults: result.length,\n          searchType: searchType\n        }));\n      }\n    } else if (type === 'TEXT') {\n      let filtered = [...clients];\n      if (params.ubi) {\n        filtered = filtered.filter(client => client.UBI.toLowerCase().includes(params.ubi.toLowerCase()));\n      }\n      if (params.lastName) {\n        filtered = filtered.filter(client => client.lastName.toLowerCase().includes(params.lastName.toLowerCase()));\n      }\n      if (params.firstName) {\n        filtered = filtered.filter(client => client.firstName.toLowerCase().includes(params.firstName.toLowerCase()));\n      }\n      setFilteredClients(filtered);\n      setQueryInfo(prev => ({\n        ...prev,\n        totalResults: filtered.length,\n        searchType: 'Text Search'\n      }));\n    }\n  };\n  const handleShowHistory = async ubi => {\n    try {\n      setHistoryLoading(true);\n      const history = await getClientHistory(ubi);\n      setSelectedClientHistory(history);\n      setShowHistory(true);\n    } catch (err) {\n      setError(err.message);\n    } finally {\n      setHistoryLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container mx-auto px-4 py-6\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-6\",\n      children: [/*#__PURE__*/_jsxDEV(ClientSearchBar, {\n        onSearch: handleSearch,\n        clients: clients // Passer la liste des clients\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ClientListBase, {\n        title: \"Clients Actifs\",\n        clients: filteredClients,\n        queryInfo: queryInfo,\n        loading: loading,\n        error: error,\n        onShowHistory: handleShowHistory,\n        showSimilarity: (queryInfo === null || queryInfo === void 0 ? void 0 : queryInfo.searchType) === 'Face Recognition',\n        message: queryInfo === null || queryInfo === void 0 ? void 0 : queryInfo.message // Ajout du message\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 9\n      }, this), showHistory && /*#__PURE__*/_jsxDEV(ClientHistoryModal, {\n        history: selectedClientHistory,\n        onClose: () => {\n          setShowHistory(false);\n          setSelectedClientHistory(null);\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 11\n      }, this), historyLoading && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"animate-spin rounded-full h-12 w-12 border-b-2 border-white\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 105,\n    columnNumber: 5\n  }, this);\n}\n_s(ActiveClientList, \"e7wkchvH40SCLZsW6J3h1aQ+aAo=\");\n_c = ActiveClientList;\nvar _c;\n$RefreshReg$(_c, \"ActiveClientList\");","map":{"version":3,"names":["React","useState","useEffect","getActiveClients","getClientHistory","ClientListBase","ClientHistoryModal","ClientSearchBar","jsxDEV","_jsxDEV","ActiveClientList","_s","clients","setClients","filteredClients","setFilteredClients","queryInfo","setQueryInfo","loading","setLoading","error","setError","showHistory","setShowHistory","selectedClientHistory","setSelectedClientHistory","historyLoading","setHistoryLoading","loadClients","response","err","message","handleSearch","type","params","result","searchError","searchType","length","prev","totalResults","filtered","ubi","filter","client","UBI","toLowerCase","includes","lastName","firstName","handleShowHistory","history","className","children","onSearch","fileName","_jsxFileName","lineNumber","columnNumber","title","onShowHistory","showSimilarity","onClose","_c","$RefreshReg$"],"sources":["/home/hlfuser/Bureau/HLF_project_jyen/bceao-blockchain-app/frontend/src/components/ActiveClientList.js"],"sourcesContent":["// frontend/src/components/ActiveClientList.js\nimport React, { useState, useEffect } from 'react';\nimport { getActiveClients, getClientHistory } from '../services/api';\nimport ClientListBase from './common/ClientListBase';\nimport ClientHistoryModal from './common/ClientHistoryModal';\nimport ClientSearchBar from './common/ClientSearchBar';\n\nexport default function ActiveClientList() {\n  const [clients, setClients] = useState([]);\n  const [filteredClients, setFilteredClients] = useState([]);\n  const [queryInfo, setQueryInfo] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [showHistory, setShowHistory] = useState(false);\n  const [selectedClientHistory, setSelectedClientHistory] = useState(null);\n  const [historyLoading, setHistoryLoading] = useState(false);\n\n  useEffect(() => {\n    loadClients();\n  }, []);\n\n  const loadClients = async () => {\n    try {\n      setLoading(true);\n      const response = await getActiveClients();\n\n      if (response?.clients) {\n        setClients(response.clients);\n        setFilteredClients(response.clients);\n        setQueryInfo(response.queryInfo);\n      }\n    } catch (err) {\n      setError(err.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleSearch = ({ type, params, result, error: searchError, searchType }) => {\n    if (searchError) {\n        setError(searchError);\n        return;\n    }\n\n    if (type === 'FACE') {\n      // Si aucun résultat similaire n'est trouvé\n      if (!result || result.length === 0) {\n          setFilteredClients([]);\n          setQueryInfo(prev => ({\n              ...prev,\n              totalResults: 0,\n              searchType: searchType,\n              message: \"Aucun client similaire trouvé\"\n          }));\n      } else {\n          setFilteredClients(result);\n          setQueryInfo(prev => ({\n              ...prev,\n              totalResults: result.length,\n              searchType: searchType\n          }));\n      }\n    } else if (type === 'TEXT') {\n        let filtered = [...clients];\n        \n        if (params.ubi) {\n            filtered = filtered.filter(client =>\n                client.UBI.toLowerCase().includes(params.ubi.toLowerCase())\n            );\n        }\n        if (params.lastName) {\n            filtered = filtered.filter(client =>\n                client.lastName.toLowerCase().includes(params.lastName.toLowerCase())\n            );\n        }\n        if (params.firstName) {\n            filtered = filtered.filter(client =>\n                client.firstName.toLowerCase().includes(params.firstName.toLowerCase())\n            );\n        }\n\n        setFilteredClients(filtered);\n        setQueryInfo(prev => ({\n            ...prev,\n            totalResults: filtered.length,\n            searchType: 'Text Search'\n        }));\n    }\n  };\n\n  const handleShowHistory = async (ubi) => {\n    try {\n      setHistoryLoading(true);\n      const history = await getClientHistory(ubi);\n      setSelectedClientHistory(history);\n      setShowHistory(true);\n    } catch (err) {\n      setError(err.message);\n    } finally {\n      setHistoryLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"container mx-auto px-4 py-6\">\n      <div className=\"space-y-6\">\n        <ClientSearchBar \n          onSearch={handleSearch} \n          clients={clients} // Passer la liste des clients\n        />\n        <ClientListBase\n          title=\"Clients Actifs\"\n          clients={filteredClients}\n          queryInfo={queryInfo}\n          loading={loading}\n          error={error}\n          onShowHistory={handleShowHistory}\n          showSimilarity={queryInfo?.searchType === 'Face Recognition'}\n          message={queryInfo?.message} // Ajout du message\n        />\n\n        {showHistory && (\n          <ClientHistoryModal\n            history={selectedClientHistory}\n            onClose={() => {\n              setShowHistory(false);\n              setSelectedClientHistory(null);\n            }}\n          />\n        )}\n\n        {historyLoading && (\n          <div className=\"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center\">\n            <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-white\" />\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}