{"ast":null,"code":"var _jsxFileName = \"/home/hlfuser/Bureau/HLF_project_jyen/bceao-blockchain-app/frontend/src/components/ActiveClientList.js\",\n  _s = $RefreshSig$();\n// frontend/src/components/ActiveClientList.js\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { getActiveClients, getClientHistory } from '../services/api';\nimport ClientListBase from './common/ClientListBase';\nimport ClientHistoryModal from './common/ClientHistoryModal';\nimport ClientSearchBar from './common/ClientSearchBar';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function ActiveClientList() {\n  _s();\n  const [clients, setClients] = useState([]);\n  const [filteredClients, setFilteredClients] = useState([]); // Ajout de l'état pour les clients filtrés\n  const [queryInfo, setQueryInfo] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  // États pour le modal d'historique\n  const [showHistory, setShowHistory] = useState(false);\n  const [selectedClientHistory, setSelectedClientHistory] = useState(null);\n  const [historyLoading, setHistoryLoading] = useState(false);\n  useEffect(() => {\n    loadClients();\n  }, []);\n  const loadClients = async () => {\n    try {\n      setLoading(true);\n      const response = await getActiveClients();\n      if (response && response.clients) {\n        setClients(response.clients);\n        setFilteredClients(response.clients); // Initialiser les clients filtrés\n        setQueryInfo(response.queryInfo);\n      } else {\n        setClients([]);\n        setFilteredClients([]);\n        console.error('Format de réponse inattendu:', response);\n      }\n    } catch (err) {\n      console.error('Erreur lors du chargement des clients:', err);\n      setError('Erreur lors du chargement des clients');\n      setClients([]);\n      setFilteredClients([]);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const handleSearch = useCallback(({\n    ubi,\n    firstName,\n    lastName\n  }) => {\n    let filtered = [...clients];\n\n    // Filtrer par UBI\n    if (ubi) {\n      filtered = filtered.filter(client => client.UBI.toLowerCase().includes(ubi.toLowerCase()));\n    }\n\n    // Filtrer par Nom\n    if (lastName) {\n      filtered = filtered.filter(client => client.lastName.toLowerCase().includes(lastName.toLowerCase()));\n    }\n\n    // Filtrer par Prénom\n    if (firstName) {\n      filtered = filtered.filter(client => client.firstName.toLowerCase().includes(firstName.toLowerCase()));\n    }\n    setFilteredClients(filtered);\n\n    // Mettre à jour queryInfo avec les résultats filtrés\n    if (queryInfo) {\n      setQueryInfo(prev => ({\n        ...prev,\n        totalResults: filtered.length\n      }));\n    }\n  }, [clients, queryInfo]);\n  const handleShowHistory = async ubi => {\n    try {\n      setHistoryLoading(true);\n      const history = await getClientHistory(ubi);\n      setSelectedClientHistory(history);\n      setShowHistory(true);\n    } catch (err) {\n      console.error(err);\n    } finally {\n      setHistoryLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container mx-auto px-4 py-6\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-6\",\n      children: [/*#__PURE__*/_jsxDEV(ClientSearchBar, {\n        onSearch: handleSearch\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(ClientListBase, {\n        title: \"Clients Actifs\",\n        clients: filteredClients // Utiliser les clients filtrés au lieu des clients\n        ,\n        queryInfo: queryInfo,\n        loading: loading,\n        error: error,\n        onShowHistory: handleShowHistory\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 17\n      }, this), showHistory && /*#__PURE__*/_jsxDEV(ClientHistoryModal, {\n        history: selectedClientHistory,\n        onClose: () => {\n          setShowHistory(false);\n          setSelectedClientHistory(null);\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 21\n      }, this), historyLoading && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"animate-spin rounded-full h-12 w-12 border-b-2 border-white\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 96,\n    columnNumber: 9\n  }, this);\n}\n_s(ActiveClientList, \"yZF/Q34E2bqkau2mwvT5t/kmhYU=\");\n_c = ActiveClientList;\nvar _c;\n$RefreshReg$(_c, \"ActiveClientList\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","getActiveClients","getClientHistory","ClientListBase","ClientHistoryModal","ClientSearchBar","jsxDEV","_jsxDEV","ActiveClientList","_s","clients","setClients","filteredClients","setFilteredClients","queryInfo","setQueryInfo","loading","setLoading","error","setError","showHistory","setShowHistory","selectedClientHistory","setSelectedClientHistory","historyLoading","setHistoryLoading","loadClients","response","console","err","handleSearch","ubi","firstName","lastName","filtered","filter","client","UBI","toLowerCase","includes","prev","totalResults","length","handleShowHistory","history","className","children","onSearch","fileName","_jsxFileName","lineNumber","columnNumber","title","onShowHistory","onClose","_c","$RefreshReg$"],"sources":["/home/hlfuser/Bureau/HLF_project_jyen/bceao-blockchain-app/frontend/src/components/ActiveClientList.js"],"sourcesContent":["// frontend/src/components/ActiveClientList.js\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { getActiveClients, getClientHistory } from '../services/api';\nimport ClientListBase from './common/ClientListBase';\nimport ClientHistoryModal from './common/ClientHistoryModal';\nimport ClientSearchBar from './common/ClientSearchBar';\n\nexport default function ActiveClientList() {\n    const [clients, setClients] = useState([]);\n    const [filteredClients, setFilteredClients] = useState([]); // Ajout de l'état pour les clients filtrés\n    const [queryInfo, setQueryInfo] = useState(null);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState(null);\n    \n    // États pour le modal d'historique\n    const [showHistory, setShowHistory] = useState(false);\n    const [selectedClientHistory, setSelectedClientHistory] = useState(null);\n    const [historyLoading, setHistoryLoading] = useState(false);\n\n    useEffect(() => {\n        loadClients();\n    }, []);\n\n    const loadClients = async () => {\n        try {\n            setLoading(true);\n            const response = await getActiveClients();\n            if (response && response.clients) {\n                setClients(response.clients);\n                setFilteredClients(response.clients); // Initialiser les clients filtrés\n                setQueryInfo(response.queryInfo);\n            } else {\n                setClients([]);\n                setFilteredClients([]);\n                console.error('Format de réponse inattendu:', response);\n            }\n        } catch (err) {\n            console.error('Erreur lors du chargement des clients:', err);\n            setError('Erreur lors du chargement des clients');\n            setClients([]);\n            setFilteredClients([]);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleSearch = useCallback(({ ubi, firstName, lastName }) => {\n        let filtered = [...clients];\n\n        // Filtrer par UBI\n        if (ubi) {\n            filtered = filtered.filter(client =>\n                client.UBI.toLowerCase().includes(ubi.toLowerCase())\n            );\n        }\n\n        // Filtrer par Nom\n        if (lastName) {\n            filtered = filtered.filter(client =>\n                client.lastName.toLowerCase().includes(lastName.toLowerCase())\n            );\n        }\n\n        // Filtrer par Prénom\n        if (firstName) {\n            filtered = filtered.filter(client =>\n                client.firstName.toLowerCase().includes(firstName.toLowerCase())\n            );\n        }\n\n        setFilteredClients(filtered);\n\n        // Mettre à jour queryInfo avec les résultats filtrés\n        if (queryInfo) {\n            setQueryInfo(prev => ({\n                ...prev,\n                totalResults: filtered.length\n            }));\n        }\n    }, [clients, queryInfo]);\n\n    const handleShowHistory = async (ubi) => {\n        try {\n            setHistoryLoading(true);\n            const history = await getClientHistory(ubi);\n            setSelectedClientHistory(history);\n            setShowHistory(true);\n        } catch (err) {\n            console.error(err);\n        } finally {\n            setHistoryLoading(false);\n        }\n    };\n\n    return (\n        <div className=\"container mx-auto px-4 py-6\">\n            <div className=\"space-y-6\">\n                {/* Barre de recherche */}\n                <ClientSearchBar onSearch={handleSearch} />\n\n                {/* Liste des clients */}\n                <ClientListBase\n                    title=\"Clients Actifs\"\n                    clients={filteredClients} // Utiliser les clients filtrés au lieu des clients\n                    queryInfo={queryInfo}\n                    loading={loading}\n                    error={error}\n                    onShowHistory={handleShowHistory}\n                />\n\n                {/* Modal d'historique */}\n                {showHistory && (\n                    <ClientHistoryModal\n                        history={selectedClientHistory}\n                        onClose={() => {\n                            setShowHistory(false);\n                            setSelectedClientHistory(null);\n                        }}\n                    />\n                )}\n\n                {/* Indicateur de chargement pour l'historique */}\n                {historyLoading && (\n                    <div className=\"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center\">\n                        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-white\"></div>\n                    </div>\n                )}\n            </div>\n        </div>\n    );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}