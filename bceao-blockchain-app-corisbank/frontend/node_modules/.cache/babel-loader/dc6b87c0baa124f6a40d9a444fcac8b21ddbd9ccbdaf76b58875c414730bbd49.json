{"ast":null,"code":"var _jsxFileName = \"/home/hlfuser/Bureau/HLF_project_jyen/bceao-blockchain-app/frontend/src/components/AllClientsList.js\",\n  _s = $RefreshSig$();\n// components/AllClientsList.js\nimport React, { useState, useEffect } from 'react';\nimport { getAllClients, getClientHistory } from '../services/api';\nimport ClientListBase from './common/ClientListBase';\nimport ClientHistoryModal from './common/ClientHistoryModal';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function AllClientsList() {\n  _s();\n  const [clients, setClients] = useState([]);\n  const [queryInfo, setQueryInfo] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  // États pour le modal d'historique\n  const [showHistory, setShowHistory] = useState(false);\n  const [selectedClientHistory, setSelectedClientHistory] = useState(null);\n  const [historyLoading, setHistoryLoading] = useState(false);\n  useEffect(() => {\n    loadClients();\n  }, []);\n  const loadClients = async () => {\n    try {\n      setLoading(true);\n      const response = await getAllClients();\n\n      // La réponse est directement un tableau\n      if (Array.isArray(response)) {\n        setClients(response);\n        // Créer un objet queryInfo à partir des métadonnées du premier client\n        if (response.length > 0 && response[0].queryMetadata) {\n          setQueryInfo({\n            totalResults: response.length,\n            querier: response[0].queryMetadata.queriedBy.mspId,\n            timestamp: response[0].queryMetadata.queriedBy.timestamp\n          });\n        }\n      } else {\n        console.error('Format de réponse inattendu:', response);\n        setClients([]);\n        setQueryInfo(null);\n      }\n    } catch (err) {\n      console.error('Erreur lors du chargement des clients:', err);\n      setError('Erreur lors du chargement des clients');\n      setClients([]);\n      setQueryInfo(null);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const handleShowHistory = async ubi => {\n    try {\n      setHistoryLoading(true);\n      const history = await getClientHistory(ubi);\n      setSelectedClientHistory(history);\n      setShowHistory(true);\n    } catch (err) {\n      console.error(err);\n    } finally {\n      setHistoryLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(ClientListBase, {\n      title: \"Tous les Clients\",\n      clients: clients,\n      queryInfo: queryInfo,\n      loading: loading,\n      error: error,\n      onShowHistory: handleShowHistory\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 7\n    }, this), showHistory && /*#__PURE__*/_jsxDEV(ClientHistoryModal, {\n      history: selectedClientHistory,\n      onClose: () => {\n        setShowHistory(false);\n        setSelectedClientHistory(null);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 9\n    }, this), historyLoading && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"animate-spin rounded-full h-12 w-12 border-b-2 border-white\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true);\n}\n_s(AllClientsList, \"8S6knnJeWNIq6zjftn5Ijx1b5pA=\");\n_c = AllClientsList;\nvar _c;\n$RefreshReg$(_c, \"AllClientsList\");","map":{"version":3,"names":["React","useState","useEffect","getAllClients","getClientHistory","ClientListBase","ClientHistoryModal","jsxDEV","_jsxDEV","Fragment","_Fragment","AllClientsList","_s","clients","setClients","queryInfo","setQueryInfo","loading","setLoading","error","setError","showHistory","setShowHistory","selectedClientHistory","setSelectedClientHistory","historyLoading","setHistoryLoading","loadClients","response","Array","isArray","length","queryMetadata","totalResults","querier","queriedBy","mspId","timestamp","console","err","handleShowHistory","ubi","history","children","title","onShowHistory","fileName","_jsxFileName","lineNumber","columnNumber","onClose","className","_c","$RefreshReg$"],"sources":["/home/hlfuser/Bureau/HLF_project_jyen/bceao-blockchain-app/frontend/src/components/AllClientsList.js"],"sourcesContent":["// components/AllClientsList.js\nimport React, { useState, useEffect } from 'react';\nimport { getAllClients, getClientHistory } from '../services/api';\nimport ClientListBase from './common/ClientListBase';\nimport ClientHistoryModal from './common/ClientHistoryModal';\n\nexport default function AllClientsList() {\n  const [clients, setClients] = useState([]);\n  const [queryInfo, setQueryInfo] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  \n  // États pour le modal d'historique\n  const [showHistory, setShowHistory] = useState(false);\n  const [selectedClientHistory, setSelectedClientHistory] = useState(null);\n  const [historyLoading, setHistoryLoading] = useState(false);\n\n  useEffect(() => {\n    loadClients();\n  }, []);\n\n  const loadClients = async () => {\n    try {\n      setLoading(true);\n      const response = await getAllClients();\n      \n      // La réponse est directement un tableau\n      if (Array.isArray(response)) {\n        setClients(response);\n        // Créer un objet queryInfo à partir des métadonnées du premier client\n        if (response.length > 0 && response[0].queryMetadata) {\n          setQueryInfo({\n            totalResults: response.length,\n            querier: response[0].queryMetadata.queriedBy.mspId,\n            timestamp: response[0].queryMetadata.queriedBy.timestamp\n          });\n        }\n      } else {\n        console.error('Format de réponse inattendu:', response);\n        setClients([]);\n        setQueryInfo(null);\n      }\n    } catch (err) {\n      console.error('Erreur lors du chargement des clients:', err);\n      setError('Erreur lors du chargement des clients');\n      setClients([]);\n      setQueryInfo(null);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleShowHistory = async (ubi) => {\n    try {\n      setHistoryLoading(true);\n      const history = await getClientHistory(ubi);\n      setSelectedClientHistory(history);\n      setShowHistory(true);\n    } catch (err) {\n      console.error(err);\n    } finally {\n      setHistoryLoading(false);\n    }\n  };\n\n  return (\n    <>\n      <ClientListBase\n        title=\"Tous les Clients\"\n        clients={clients}\n        queryInfo={queryInfo}\n        loading={loading}\n        error={error}\n        onShowHistory={handleShowHistory}\n      />\n      \n      {showHistory && (\n        <ClientHistoryModal\n          history={selectedClientHistory}\n          onClose={() => {\n            setShowHistory(false);\n            setSelectedClientHistory(null);\n          }}\n        />\n      )}\n\n      {historyLoading && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-white\"></div>\n        </div>\n      )}\n    </>\n  );\n}"],"mappings":";;AAAA;AACA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAClD,SAASC,aAAa,EAAEC,gBAAgB,QAAQ,iBAAiB;AACjE,OAAOC,cAAc,MAAM,yBAAyB;AACpD,OAAOC,kBAAkB,MAAM,6BAA6B;AAAC,SAAAC,MAAA,IAAAC,OAAA,EAAAC,QAAA,IAAAC,SAAA;AAE7D,eAAe,SAASC,cAAcA,CAAA,EAAG;EAAAC,EAAA;EACvC,MAAM,CAACC,OAAO,EAAEC,UAAU,CAAC,GAAGb,QAAQ,CAAC,EAAE,CAAC;EAC1C,MAAM,CAACc,SAAS,EAAEC,YAAY,CAAC,GAAGf,QAAQ,CAAC,IAAI,CAAC;EAChD,MAAM,CAACgB,OAAO,EAAEC,UAAU,CAAC,GAAGjB,QAAQ,CAAC,IAAI,CAAC;EAC5C,MAAM,CAACkB,KAAK,EAAEC,QAAQ,CAAC,GAAGnB,QAAQ,CAAC,IAAI,CAAC;;EAExC;EACA,MAAM,CAACoB,WAAW,EAAEC,cAAc,CAAC,GAAGrB,QAAQ,CAAC,KAAK,CAAC;EACrD,MAAM,CAACsB,qBAAqB,EAAEC,wBAAwB,CAAC,GAAGvB,QAAQ,CAAC,IAAI,CAAC;EACxE,MAAM,CAACwB,cAAc,EAAEC,iBAAiB,CAAC,GAAGzB,QAAQ,CAAC,KAAK,CAAC;EAE3DC,SAAS,CAAC,MAAM;IACdyB,WAAW,CAAC,CAAC;EACf,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMA,WAAW,GAAG,MAAAA,CAAA,KAAY;IAC9B,IAAI;MACFT,UAAU,CAAC,IAAI,CAAC;MAChB,MAAMU,QAAQ,GAAG,MAAMzB,aAAa,CAAC,CAAC;;MAEtC;MACA,IAAI0B,KAAK,CAACC,OAAO,CAACF,QAAQ,CAAC,EAAE;QAC3Bd,UAAU,CAACc,QAAQ,CAAC;QACpB;QACA,IAAIA,QAAQ,CAACG,MAAM,GAAG,CAAC,IAAIH,QAAQ,CAAC,CAAC,CAAC,CAACI,aAAa,EAAE;UACpDhB,YAAY,CAAC;YACXiB,YAAY,EAAEL,QAAQ,CAACG,MAAM;YAC7BG,OAAO,EAAEN,QAAQ,CAAC,CAAC,CAAC,CAACI,aAAa,CAACG,SAAS,CAACC,KAAK;YAClDC,SAAS,EAAET,QAAQ,CAAC,CAAC,CAAC,CAACI,aAAa,CAACG,SAAS,CAACE;UACjD,CAAC,CAAC;QACJ;MACF,CAAC,MAAM;QACLC,OAAO,CAACnB,KAAK,CAAC,8BAA8B,EAAES,QAAQ,CAAC;QACvDd,UAAU,CAAC,EAAE,CAAC;QACdE,YAAY,CAAC,IAAI,CAAC;MACpB;IACF,CAAC,CAAC,OAAOuB,GAAG,EAAE;MACZD,OAAO,CAACnB,KAAK,CAAC,wCAAwC,EAAEoB,GAAG,CAAC;MAC5DnB,QAAQ,CAAC,uCAAuC,CAAC;MACjDN,UAAU,CAAC,EAAE,CAAC;MACdE,YAAY,CAAC,IAAI,CAAC;IACpB,CAAC,SAAS;MACRE,UAAU,CAAC,KAAK,CAAC;IACnB;EACF,CAAC;EAED,MAAMsB,iBAAiB,GAAG,MAAOC,GAAG,IAAK;IACvC,IAAI;MACFf,iBAAiB,CAAC,IAAI,CAAC;MACvB,MAAMgB,OAAO,GAAG,MAAMtC,gBAAgB,CAACqC,GAAG,CAAC;MAC3CjB,wBAAwB,CAACkB,OAAO,CAAC;MACjCpB,cAAc,CAAC,IAAI,CAAC;IACtB,CAAC,CAAC,OAAOiB,GAAG,EAAE;MACZD,OAAO,CAACnB,KAAK,CAACoB,GAAG,CAAC;IACpB,CAAC,SAAS;MACRb,iBAAiB,CAAC,KAAK,CAAC;IAC1B;EACF,CAAC;EAED,oBACElB,OAAA,CAAAE,SAAA;IAAAiC,QAAA,gBACEnC,OAAA,CAACH,cAAc;MACbuC,KAAK,EAAC,kBAAkB;MACxB/B,OAAO,EAAEA,OAAQ;MACjBE,SAAS,EAAEA,SAAU;MACrBE,OAAO,EAAEA,OAAQ;MACjBE,KAAK,EAAEA,KAAM;MACb0B,aAAa,EAAEL;IAAkB;MAAAM,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAClC,CAAC,EAED5B,WAAW,iBACVb,OAAA,CAACF,kBAAkB;MACjBoC,OAAO,EAAEnB,qBAAsB;MAC/B2B,OAAO,EAAEA,CAAA,KAAM;QACb5B,cAAc,CAAC,KAAK,CAAC;QACrBE,wBAAwB,CAAC,IAAI,CAAC;MAChC;IAAE;MAAAsB,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CACF,EAEAxB,cAAc,iBACbjB,OAAA;MAAK2C,SAAS,EAAC,4EAA4E;MAAAR,QAAA,eACzFnC,OAAA;QAAK2C,SAAS,EAAC;MAA6D;QAAAL,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAM;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAChF,CACN;EAAA,eACD,CAAC;AAEP;AAACrC,EAAA,CAvFuBD,cAAc;AAAAyC,EAAA,GAAdzC,cAAc;AAAA,IAAAyC,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}